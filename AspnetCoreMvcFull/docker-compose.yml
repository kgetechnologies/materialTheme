version: '3.9'
services:
  web:
    container_name: dotnet-mvc-full-app  # Name your container
    build:
      context: . # The directory that contains the Dockerfile
      dockerfile: Dockerfile # Path to the Dockerfile
    ports:
      - '5050:80' # Map container port 80 to host port 5050
    environment:
      - ASPNETCORE_URLS=http://+:80  # Set the environment variable to configure the app's URLs
      - DB_CONNECTION_STRING=${DB_CONNECTION_STRING}  # Example of using environment variables from .env
    volumes:
      - ./data:/app/data  # Persist app data
    restart: always  # Automatically restart the container on failure
    depends_on:
      - db  # If your app depends on a database service (example)

  db:
    image: postgres:latest  # Example of a database service
    environment:
      POSTGRES_USER: exampleuser
      POSTGRES_PASSWORD: examplepassword
      POSTGRES_DB: exampledb
    volumes:
      - ./db-data:/var/lib/postgresql/data  # Persist database data
